# .github/workflows/debug-build.yml
name: Debug Build Failure

on: [push, workflow_dispatch]

jobs:
  debug-build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
      
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18'
      
      - name: Check Node and NPM versions
        run: |
          echo "Node version:"
          node --version
          echo "NPM version:"
          npm --version
          echo "Current directory:"
          pwd
          ls -la
      
      - name: Check package.json
        run: |
          echo "=== PACKAGE.JSON ==="
          cat package.json
          echo "=== SCRIPTS ==="
          npm run
      
      - name: Install dependencies with verbose output
        run: |
          echo "Installing dependencies..."
          npm install --loglevel=verbose 2>&1 | tail -50
      
      - name: Try build with debug
        run: |
          echo "Attempting build..."
          # Captura el error completo
          npm run build 2>&1 || echo "Build failed with exit code: $?"
      
      - name: List all files after attempt
        run: |
          echo "=== ALL FILES AFTER BUILD ATTEMPT ==="
          find . -type f | head -30
