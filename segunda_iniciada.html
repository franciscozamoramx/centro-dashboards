<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Centro de Business Intelligence - Big Bola Casinos</title>
    <link rel="icon" type="image/png" href="https://i.postimg.cc/QCN4dPG1/analisis-de-datos.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: white;
            height: 100vh;
            overflow: hidden;
        }
        
        .hamburger-btn {
            position: fixed;
            top: 20px;
            left: 20px;
            width: 50px;
            height: 50px;
            background: #152c6e;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            z-index: 1002;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
        }
        
        .hamburger-btn:hover {
            background: #1a3a8f;
            transform: scale(1.05);
        }
        
        .sidebar {
            position: fixed;
            top: 0;
            left: -300px; /* Oculto por defecto */
            width: 280px;
            height: 100vh;
            background: #152c6e;
            overflow-y: auto;
            padding: 20px;
            box-shadow: 2px 0 10px rgba(0,0,0,0.2);
            display: flex;
            flex-direction: column;
            z-index: 1001;
            transition: left 0.3s ease;
        }
        
        .sidebar.visible {
            left: 0;
        }
        
        .sidebar-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
        }
        
        .sidebar-overlay.visible {
            display: block;
        }
        
        .sidebar-header {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px 0;
            border-bottom: 1px solid rgba(255,255,255,0.2);
            margin-bottom: 20px;
        }
        
        .sidebar-logo {
            height: 60px;
            width: auto;
            margin-bottom: 15px;
        }
        
        .sidebar-title {
            font-size: 18px;
            font-weight: bold;
            color: white;
            text-align: center;
            line-height: 1.2;
        }
        
        .user-info {
            margin-top: 10px;
            font-size: 12px;
            color: #FFD700;
            text-align: center;
        }
        
        .menu-section {
            color: #FFD700;
            font-weight: bold;
            margin: 20px 0 10px;
            padding-bottom: 5px;
            border-bottom: 1px solid rgba(255,255,255,0.2);
            font-size: 14px;
        }
        
        .menu-item {
            display: block;
            width: 100%;
            padding: 12px 15px;
            margin-bottom: 8px;
            background: rgba(255,255,255,0.1);
            color: white;
            border: none;
            border-radius: 5px;
            text-align: left;
            cursor: pointer;
            transition: background 0.3s;
            font-size: 14px;
        }
        
        .menu-item:hover { 
            background: rgba(255,255,255,0.2); 
        }
        
        .menu-item.active {
            background: rgba(255,215,0,0.3);
            border-left: 3px solid #FFD700;
        }
        
        .menu-item i {
            margin-right: 10px;
            width: 20px;
            text-align: center;
        }
        
        .sidebar-footer {
            margin-top: auto;
            padding-top: 20px;
            border-top: 1px solid rgba(255,255,255,0.2);
        }
        
        .exit-btn {
            display: block;
            width: 100%;
            padding: 12px 15px;
            background: rgba(255, 0, 0, 0.2);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: background 0.3s;
            text-align: center;
        }
        
        .exit-btn:hover { 
            background: rgba(255, 0, 0, 0.3); 
        }
        
        .iframe-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background: white;
            z-index: 1;
        }
        
        iframe {
            width: 100%;
            height: 100%;
            border: none;
        }
        
        @media (max-width: 1024px) {
            .sidebar {
                width: 250px;
                left: -270px;
            }
        }
    </style>
</head>
<body>
    <button class="hamburger-btn" id="hamburgerBtn">
        <i class="fas fa-bars"></i>
    </button>
    
    <div class="sidebar-overlay" id="sidebarOverlay"></div>
    
    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <img src="https://i.postimg.cc/hGqNYsNp/Isotipo-Perfiles-Marmol01-Photoroom.png" alt="Big Bola Casinos" class="sidebar-logo">
            <div class="sidebar-title">
                <div>Centro de</div>
                <div>Business Intelligence</div>
            </div>
            <div class="user-info">
                Usuario: guillermo.luna@bigbola.com
            </div>
        </div>
        <!-- Los elementos del menú se generarán con JavaScript -->
    </div>
    
    <div class="iframe-container">
        <iframe id="dashboardFrame"></iframe>
    </div>

    <script>
        // Mapeo de dashboards a URLs
        const dashboardUrls = {
            "principal": "https://app.powerbi.com/reportEmbed?reportId=9bd044c3-981b-4a9a-914a-b7bf130dae59&autoAuth=true&ctid=b19d1a80-fff1-4a7e-b9ce-93f694e7b65c",
            "adt": "https://app.powerbi.com/reportEmbed?reportId=1149b379-aad5-4876-bfe6-c325dc89308f&autoAuth=true&ctid=b19d1a80-fff1-4a7e-b9ce-93f694e7b65c",
            "auditoria": "https://app.powerbi.com/reportEmbed?reportId=a78289b5-2543-4104-aff7-96e30ef79b58&autoAuth=true&ctid=b19d1a80-fff1-4a7e-b9ce-93f694e7b65c",
            "bigplayers": "https://app.powerbi.com/reportEmbed?reportId=ff7ca313-9e8f-4513-9bcd-df9182f2464a&autoAuth=true&ctid=b19d1a80-fff1-4a7e-b9ce-93f694e7b65c",
            "desempeno": "https://app.powerbi.com/reportEmbed?reportId=28c07103-a77e-42f4-a9ca-7d9345b48131&autoAuth=true&ctid=b19d1a80-fff1-4a7e-b9ce-93f694e7b65c",
            "inventario": "https://app.powerbi.com/reportEmbed?reportId=4fe689c1-3fa7-4632-8367-4b7a7abc492c&autoAuth=true&ctid=b19d1a80-fff1-4a7e-b9ce-93f694e7b65c",
            "promociones": "https://app.powerbi.com/reportEmbed?reportId=7253b2c9-12b1-4a8a-b555-2fef1d62e1b3&autoAuth=true&ctid=b19d1a80-fff1-4a7e-b9ce-93f694e7b65c",
            "proyectos": "https://app.powerbi.com/reportEmbed?reportId=c2e5834e-4e3d-418c-a9dc-43e33d79a62e&autoAuth=true&ctid=b19d1a80-fff1-4a7e-b9ce-93f694e7b65c",
            "rtp": "https://app.powerbi.com/reportEmbed?reportId=01ac285e-618f-43de-be89-d62b1a46374c&autoAuth=true&ctid=b19d1a80-fff1-4a7e-b9ce-93f694e7b65c",
            "diccionario": "https://app.powerbi.com/reportEmbed?reportId=95918a25-c06b-411a-a346-f462b03e557b&autoAuth=true&ctid=b19d1a80-fff1-4a7e-b9ce-93f694e7b65c"
        };

        // Mapeo de nombres de dashboards
        const dashboardNames = {
            "principal": "Principal",
            "adt": "ADT",
            "auditoria": "Auditoría de Salas",
            "bigplayers": "Big Player's",
            "desempeno": "Desempeño de Máquinas",
            "inventario": "Inventario TI",
            "promociones": "Promociones",
            "proyectos": "Proyectos BI",
            "rtp": "RTP",
            "diccionario": "Diccionario KPI's"
        };

        // Mapeo de íconos para dashboards
        const dashboardIcons = {
            "principal": "fas fa-house",
            "adt": "fas fa-chart-line",
            "auditoria": "fas fa-search",
            "bigplayers": "fas fa-gem",
            "desempeno": "fas fa-tachometer-alt",
            "inventario": "fas fa-desktop",
            "promociones": "fas fa-gift",
            "proyectos": "fas fa-project-diagram",
            "rtp": "fas fa-coins",
            "diccionario": "fas fa-book"
        };

        // Permisos del usuario guillermo.luna@bigbola.com
        const currentUserPermissions = [
            "principal", "adt", "bigplayers", "desempeno", 
            "proyectos", "promociones", "rtp", "diccionario"
        ];

        document.addEventListener('DOMContentLoaded', function() {
            const hamburgerBtn = document.getElementById('hamburgerBtn');
            const sidebar = document.getElementById('sidebar');
            const sidebarOverlay = document.getElementById('sidebarOverlay');
            const iframe = document.getElementById('dashboardFrame');
            
            let isSidebarVisible = false; // Inicia oculto
            
            // Generar menú basado en los permisos del usuario
            generateMenu(sidebar);
            
            // Cargar dashboard principal por defecto
            if (currentUserPermissions.includes('principal')) {
                iframe.src = dashboardUrls.principal;
                // Activar el botón del dashboard principal
                const principalBtn = document.querySelector('[data-src="' + dashboardUrls.principal + '"]');
                if (principalBtn) {
                    principalBtn.classList.add('active');
                }
            } else if (currentUserPermissions.length > 0) {
                // Si no tiene acceso al principal, cargar el primero de la lista
                const firstDashboard = currentUserPermissions[0];
                iframe.src = dashboardUrls[firstDashboard];
                const firstBtn = document.querySelector('[data-src="' + dashboardUrls[firstDashboard] + '"]');
                if (firstBtn) {
                    firstBtn.classList.add('active');
                }
            }
            
            // Configurar eventos para los botones del menú
            setupMenuEvents();
            
            // Función para alternar visibilidad del sidebar
            function toggleSidebar() {
                isSidebarVisible = !isSidebarVisible;
                
                if (isSidebarVisible) {
                    // Mostrar sidebar
                    sidebar.classList.add('visible');
                    sidebarOverlay.classList.add('visible');
                    hamburgerBtn.innerHTML = '<i class="fas fa-times"></i>';
                } else {
                    // Ocultar sidebar
                    sidebar.classList.remove('visible');
                    sidebarOverlay.classList.remove('visible');
                    hamburgerBtn.innerHTML = '<i class="fas fa-bars"></i>';
                }
            }
            
            // Evento para el botón hamburguesa
            hamburgerBtn.addEventListener('click', toggleSidebar);
            
            // Evento para cerrar el sidebar al hacer clic en el overlay
            sidebarOverlay.addEventListener('click', toggleSidebar);
            
            // Evento para cerrar el sidebar al hacer clic en un item del menú
            const menuItems = document.querySelectorAll('.menu-item[data-src]');
            menuItems.forEach(item => {
                item.addEventListener('click', function() {
                    // Cerrar sidebar después de seleccionar un dashboard
                    if (isSidebarVisible) {
                        toggleSidebar();
                    }
                });
            });
        });

        function generateMenu(sidebarElement) {
            let menuItemsHTML = '';
            
            // Dashboard principal
            if (currentUserPermissions.includes('principal')) {
                menuItemsHTML += `
                    <button class="menu-item" data-src="${dashboardUrls.principal}">
                        <i class="${dashboardIcons.principal}"></i> ${dashboardNames.principal}
                    </button>
                `;
            }
            
            // Otros dashboards (excluyendo principal y diccionario)
            const otherDashboards = currentUserPermissions.filter(d => d !== 'principal' && d !== 'diccionario');
            if (otherDashboards.length > 0) {
                menuItemsHTML += `<div class="menu-section">Dashboards</div>`;
                
                otherDashboards.forEach(dashboard => {
                    if (dashboardUrls[dashboard]) {
                        menuItemsHTML += `
                            <button class="menu-item" data-src="${dashboardUrls[dashboard]}">
                                <i class="${dashboardIcons[dashboard]}"></i> ${dashboardNames[dashboard]}
                            </button>
                        `;
                    }
                });
            }
            
            // Herramientas
            menuItemsHTML += `<div class="menu-section">Herramientas</div>`;
            
            // Diccionario KPI's
            if (currentUserPermissions.includes('diccionario')) {
                menuItemsHTML += `
                    <button class="menu-item" data-src="${dashboardUrls.diccionario}">
                        <i class="${dashboardIcons.diccionario}"></i> ${dashboardNames.diccionario}
                    </button>
                `;
            }
            
            // Botón de ayuda de WhatsApp
            menuItemsHTML += `
                <button class="menu-item" id="whatsappBtn">
                    <i class="fab fa-whatsapp"></i> Ayuda
                </button>
            `;
            
            // Botón de salir
            menuItemsHTML += `
                <div class="sidebar-footer">
                    <button class="exit-btn" id="exitBtn">
                        <i class="fas fa-sign-out-alt"></i> Salir
                    </button>
                </div>
            `;
            
            // Insertar el menú generado
            sidebarElement.innerHTML += menuItemsHTML;
        }

        function setupMenuEvents() {
            const menuItems = document.querySelectorAll('.menu-item[data-src]');
            const iframe = document.getElementById('dashboardFrame');
            const whatsappBtn = document.getElementById('whatsappBtn');
            const exitBtn = document.getElementById('exitBtn');
            
            // Evento para cambiar de dashboard
            menuItems.forEach(item => {
                item.addEventListener('click', function() {
                    const dashboardUrl = this.getAttribute('data-src');
                    
                    if (dashboardUrl) {
                        // Remover clase active de todos los botones
                        menuItems.forEach(menuItem => {
                            menuItem.classList.remove('active');
                        });
                        
                        // Agregar clase active al botón clickeado
                        this.classList.add('active');
                        
                        // Cambiar el src del iframe
                        iframe.src = dashboardUrl;
                    }
                });
            });
            
            // Evento para botón de WhatsApp
            if (whatsappBtn) {
                whatsappBtn.addEventListener('click', function() {
                    const phoneNumber = '+524421974414';
                    const message = 'Hola, necesito ayuda en el Centro de Business Intelligence';
                    const url = 'https://wa.me/' + phoneNumber + '?text=' + encodeURIComponent(message);
                    window.open(url, '_blank');
                });
            }
            
            // Evento para botón de salir
            if (exitBtn) {
                exitBtn.addEventListener('click', function() {
                    if (confirm('¿Estás seguro de que quieres salir del Centro de Business Intelligence?')) {
                        // Cerrar la ventana si está abierta como popup, o redirigir
                        if (window.opener) {
                            window.close();
                        } else {
                            // Si es una ventana normal, simplemente podrías redirigir o dejar como está
                            alert('Para salir, simplemente cierra esta pestaña del navegador.');
                        }
                    }
                });
            }
        }
    </script>
</body>
</html>